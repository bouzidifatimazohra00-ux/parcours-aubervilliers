<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Parcours photo sensible – Aubervilliers</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#111;
  --card:#1e1e1e;
  --text:#f5f5f5;
  --muted:#bbb;
  --accent:#2563eb;
  --border:#333;
}

/* Global */
body{margin:0;font-family:system-ui;background:var(--bg);color:var(--text);padding:2rem;}
h1,h2{text-align:center;margin-bottom:1rem;}
h1{font-size:2rem;}
h2{font-size:1.2rem;color:var(--muted);margin-bottom:2rem;}
.intro{text-align:center;color:var(--muted);max-width:800px;margin:0 auto 2rem;line-height:1.5;}

/* Carte */
.map{height:450px;border-radius:12px;border:1px solid var(--border);margin-bottom:2rem;}

/* Layout de la section inférieure */
.lower-section{display:grid;grid-template-columns:1fr 1fr;gap:2rem;}
@media(max-width:900px){.lower-section{grid-template-columns:1fr;}}

/* Timeline */
.timeline{overflow-y:auto;max-height:600px;}
.step{background:var(--card);padding:1rem;margin-bottom:1rem;border-radius:10px;border:1px solid var(--border);cursor:pointer;transition:0.3s;}
.step:hover{background:rgba(37,99,235,0.2);}
.step.active{border:2px solid var(--accent);}
.step img{width:100%;border-radius:6px;margin-top:.5rem;}
.step .tags{display:flex;gap:.3rem;flex-wrap:wrap;margin-top:.5rem;}
.step .tag{background:#2563eb;color:#fff;padding:.2rem .5rem;border-radius:999px;font-size:.75rem;}
.step .tag.intensity{background:#9333ea;}
.step .meta{color:var(--muted);font-size:.85rem;margin-top:.3rem;}

/* Graphiques */
.graphs{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;}
@media(max-width:900px){.graphs{grid-template-columns:1fr;}}
.card{background:var(--card);padding:1rem;border-radius:12px;border:1px solid var(--border);}
.meta{color:var(--muted);font-size:.9rem;margin-top:.5rem;}
</style>
</head>
<body>

<h1>Parcours photographique sensible – Aubervilliers</h1>
<h2>Marche urbaine, données et ressentis</h2>
<div class="intro">
Cette visualisation retrace une marche photographique à Aubervilliers. Chaque image est associée à des données spatiales, temporelles et sensibles.
</div>

<!-- Carte en haut -->
<div id="map" class="map"></div>

<!-- Section inférieure : gauche timeline, droite graphiques + conclusion -->
<div class="lower-section">
  <div class="timeline" id="timeline"></div>
  <div class="graphs">
    <div class="card">
      <h3>Altitude du parcours</h3>
      <canvas id="altitudeChart"></canvas>
    </div>
    <div class="card">
      <h3>Évolution du ressenti</h3>
      <canvas id="emotionChart"></canvas>
    </div>
    <div class="card">
      <h3>Formats photographiques</h3>
      <canvas id="dimensionChart"></canvas>
    </div>
    <div class="card">
      <h3>Conclusion</h3>
      <p class="meta">
        Cette balade met en évidence l’influence directe de l’environnement urbain
        sur le ressenti et la manière de photographier.
        Les lieux institutionnels et commerciaux génèrent une intensité plus forte,
        alors que le Jardin, la Star Academy et le Quartier ancien introduisent
        des pauses et des moments de respiration, tant dans le rythme de marche
        que dans le regard photographique.
      </p>
    </div>
  </div>
</div>

<script>
// ================== Données ==================
const points = [
  {id:"A", name:"Humathèque", coords:[48.9129,2.3658], img:"image0 (1).jpeg", alt:0, emotion:1, dim:"1152x2048", espace:"Institutionnel", desc:"Bibliothèque et lieu institutionnel."},
  {id:"B", name:"Supermarché proche", coords:[48.9131,2.3662], img:"IMG_7841.JPG", alt:0, emotion:2, dim:"1152x2048", espace:"Commercial / Média", desc:"Zone commerciale et flux important."},
  {id:"C", name:"Passage piéton", coords:[48.9134,2.3668], img:"IMG_7840(2).JPG", alt:0, emotion:3, dim:"1152x2048", espace:"Flux / Résidentiel", desc:"Espace résidentiel et circulation."},
  {id:"D", name:"Studio 217 – Star Academy", coords:[48.9192,2.3751], img:"IMG_7836.JPG", alt:0, emotion:5, dim:"1152x2048", espace:"Commercial / Média", desc:"Lieu commercial et artistique."},
  {id:"E", name:"Jardin / espace vert", coords:[48.9172,2.3728], img:"IMG_7835.JPG", alt:0, emotion:1, dim:"1152x2048", espace:"Vert", desc:"Espace vert et détente."},
  {id:"F", name:"Quartier ancien", coords:[48.9121,2.3821], img:"IMG_6981.jpg", alt:0, emotion:2, dim:"1536x2048", espace:"Flux / Résidentiel", desc:"Quartier historique et calme."},
  {id:"G", name:"CIFA Fashion Business Center", coords:[48.9181,2.3733], img:"IMG_7834.JPG", alt:0, emotion:4, dim:"1152x2048", espace:"Commercial / Média", desc:"Centre commercial et bureaux."}
];

// ================== Timeline ==================
let currentStep=null;
const timeline=document.getElementById("timeline");

function renderTimeline(){
  timeline.innerHTML="";
  points.forEach(p=>{
    const step=document.createElement("div");
    step.className="step";
    step.dataset.id=p.id;
    step.innerHTML=`<strong>${p.name}</strong><img src="${p.img}" alt="${p.name}"><div class="tags"><span class="tag">${p.espace}</span><span class="tag intensity">Intensité ${"█".repeat(p.emotion)}${"░".repeat(5-p.emotion)}</span></div><div class="meta">${p.desc}</div>`;
    step.onclick=()=>focusStep(p.id);
    timeline.appendChild(step);
  });
}

function focusStep(id){
  if(currentStep) currentStep.classList.remove("active");
  const step=document.querySelector(`.step[data-id='${id}']`);
  if(step){step.classList.add("active");step.scrollIntoView({behavior:"smooth",block:"center"});currentStep=step;}
}

// ================== Carte Leaflet ==================
const map = L.map("map").setView([48.914, 2.372], 14);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(map);
const latlngs=[];
points.forEach(p=>{
  latlngs.push(p.coords);
  const marker=L.marker(p.coords).addTo(map).bindPopup(`<strong>${p.name}</strong><br>${p.desc}`);
  marker.on('click',()=>focusStep(p.id));
});
L.polyline(latlngs,{color:'#2563eb',weight:4,opacity:0.7}).addTo(map);

renderTimeline();

// ================== Graphiques ==================
new Chart(document.getElementById('altitudeChart'),{
  type:'line',
  data:{labels:points.map(p=>p.name),datasets:[{label:'Altitude',data:points.map(p=>p.alt),borderColor:'#2563eb',backgroundColor:'rgba(37,99,235,0.1)',tension:0.3,fill:true}]},
  options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
});

new Chart(document.getElementById('emotionChart'),{
  type:'line',
  data:{labels:points.map(p=>p.name),datasets:[{label:'Émotion',data:points.map(p=>p.emotion),borderColor:'#f59e0b',backgroundColor:'rgba(245,158,11,0.1)',tension:0.3,fill:true}]},
  options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{min:0,max:5,stepSize:1}}}
});

new Chart(document.getElementById('dimensionChart'),{
  type:'bar',
  data:{labels:points.map(p=>p.name),datasets:[
    {label:'Largeur (px)',data:points.map(p=>parseInt(p.dim.split('x')[0])),backgroundColor:'#22c55e'},
    {label:'Hauteur (px)',data:points.map(p=>parseInt(p.dim.split('x')[1])),backgroundColor:'#9333ea'}
  ]},
  options:{responsive:true,plugins:{legend:{position:'top'}}}
});
</script>
</body>
</html>
