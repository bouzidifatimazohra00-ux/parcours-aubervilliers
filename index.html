<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Parcours photographique sensible ‚Äì Aubervilliers</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet CSS & JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#111111;
  --card:#1e1e1e;
  --text:#f5f5f5;
  --muted:#bbbbbb;
  --accent:#2563eb;
  --border:#333333;
  --fade-duration:.8s;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;}

body{
  background:var(--bg);
  color:var(--text);
  line-height:1.6;
  padding:2rem 1rem 4rem;
}

.page{max-width:1200px;margin:0 auto;}

h1{text-align:center;font-size:2rem;margin-bottom:.3rem;}
h2{text-align:center;font-size:1.1rem;color:var(--muted);margin-bottom:2rem;}

.intro{
  max-width:760px;
  margin:1.5rem auto 3rem;
  font-size:1rem;
  color:var(--muted);
  text-align:center;
}

.map{
  height:450px;
  border-radius:16px;
  overflow:hidden;
  border:1px solid var(--border);
  margin-bottom:1.5rem;
}

/* Timeline horizontale */
.timeline{
  display:flex;
  overflow-x:auto;
  gap:1rem;
  padding:1rem 0;
  scroll-behavior: smooth;
}

.step{
  min-width:200px;
  flex-shrink:0;
  border:2px solid transparent;
  border-radius:10px;
  background:var(--card);
  padding:.5rem;
  cursor:pointer;
  opacity:0;
  transform:translateY(15px);
  transition:opacity var(--fade-duration),transform var(--fade-duration),border 0.3s, background 0.3s;
}

.step.visible{opacity:1;transform:translateY(0);}
.step.active{border-color:var(--accent); background:rgba(37,99,235,0.2);}

.step .marker{
  display:none;
}

.step strong{display:block;margin-bottom:.3rem;}
.photo{display:grid;grid-template-columns:1fr;gap:.5rem;}
.photo img{width:100%;border-radius:8px;object-fit:cover;}
.tags{display:flex;flex-wrap:wrap;gap:.3rem;margin-bottom:.3rem;}
.tag{background:#2563eb;color:#fff;padding:.15rem .5rem;border-radius:999px;font-size:.75rem;font-weight:500;}
.tag.intensity{background:#9333ea;}

.graphs{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:1.5rem;
  margin-top:2rem;
}

@media(max-width:900px){
  .graphs{grid-template-columns:1fr;}
}

.card{
  background:var(--card);
  padding:1rem;
  border-radius:12px;
  border:1px solid var(--border);
}

.meta{font-size:.8rem;color:var(--muted);margin-top:.3rem;}

footer{text-align:center;color:var(--muted);margin-top:3rem;font-size:.75rem;}

.legend{
  display:flex;
  flex-wrap:wrap;
  gap:1rem;
  font-size:.8rem;
  justify-content:center;
  margin-bottom:1rem;
}
.legend span{
  display:inline-flex;
  align-items:center;
  gap:.3rem;
  cursor:pointer;
}
.legend .box{
  width:12px;
  height:12px;
  display:inline-block;
  border-radius:3px;
  border:1px solid #fff;
}
.legend .active{border:2px solid #fff;}
</style>
</head>

<body>
<main class="page">

<h1>Parcours photographique sensible ‚Äì Aubervilliers</h1>
<h2>Marche urbaine, donn√©es et ressentis</h2>

<div class="intro">
Cette visualisation retrace une marche photographique √† Aubervilliers.
Chaque image est associ√©e √† des donn√©es spatiales, temporelles et sensibles.
</div>

<div class="legend">
  <span data-filter="Institutionnel"><div class="box" style="background:#3b82f6"></div> Institutionnel</span>
  <span data-filter="Commercial / M√©dia"><div class="box" style="background:#9333ea"></div> Commercial / M√©dia</span>
  <span data-filter="Vert"><div class="box" style="background:#22c55e"></div> Vert</span>
  <span data-filter="Flux / R√©sidentiel"><div class="box" style="background:#f59e0b"></div> Flux / R√©sidentiel</span>
  <span data-filter="all"><div class="box" style="background:#ffffff"></div> Tous</span>
</div>

<div id="map" class="map"></div>

<div class="timeline" id="timeline"></div>

<div class="graphs">
  <div class="card">
    <h3>Altitude du parcours</h3>
    <canvas id="altitudeChart"></canvas>
  </div>
  <div class="card">
    <h3>√âvolution du ressenti</h3>
    <canvas id="emotionChart"></canvas>
    <p class="meta">
      Le ressenti √©motionnel √©volue au fil du parcours, alternant entre intensit√© urbaine et moments de pause.
    </p>
  </div>
  <div class="card">
    <h3>Formats photographiques</h3>
    <canvas id="dimensionChart"></canvas>
    <p class="meta">
      Les formats varient selon les espaces travers√©s : les lieux ouverts favorisent des cadrages plus respirants, tandis que les zones denses contraignent la prise de vue.
    </p>
  </div>
  <div class="card">
    <h3>Conclusion</h3>
    <p class="meta">
      Cette balade met en √©vidence l‚Äôinfluence directe de l‚Äôenvironnement urbain sur le ressenti et la mani√®re de photographier.
    </p>
  </div>
</div>

<footer>Projet de visualisation ‚Äì Master</footer>
</main>

<script>
// ================== Donn√©es ==================
const points = [
  {id:"A", name:"Humath√®que", coords:[48.9129,2.3658], img:"image0 (1).jpeg", time:"11:00", alt:0, emotion:1, espace:"Institutionnel", rythme:"Lent", dim:"1152x2048"},
  {id:"B", name:"Supermarch√© proche", coords:[48.9131,2.3662], img:"IMG_7841.JPG", time:"11:10", alt:0, emotion:2, espace:"Commercial / M√©dia", rythme:"Rapide", dim:"1152x2048"},
  {id:"C", name:"Passage pi√©ton", coords:[48.9134,2.3668], img:"IMG_7840(2).JPG", time:"11:20", alt:0, emotion:3, espace:"Flux / R√©sidentiel", rythme:"Rapide", dim:"1152x2048"},
  {id:"D", name:"Studio 217 ‚Äì Star Academy", coords:[48.9192,2.3751], img:"IMG_7836.JPG", time:"11:50", alt:0, emotion:5, espace:"Commercial / M√©dia", rythme:"Pause", dim:"1152x2048"},
  {id:"E", name:"Jardin / espace vert", coords:[48.9172,2.3728], img:"IMG_7835.JPG", time:"12:05", alt:0, emotion:1, espace:"Vert", rythme:"Pause", dim:"1152x2048"},
  {id:"F", name:"Quartier ancien", coords:[48.9121,2.3821], img:"IMG_6981.jpg", time:"12:25", alt:0, emotion:2, espace:"Flux / R√©sidentiel", rythme:"Pause", dim:"1536x2048"},
  {id:"G", name:"CIFA Fashion Business Center", coords:[48.9181,2.3733], img:"IMG_7834.JPG", time:"12:40", alt:0, emotion:4, espace:"Commercial / M√©dia", rythme:"Rapide", dim:"1152x2048"}
];

let currentStep=null;
const timeline=document.getElementById("timeline");

function renderTimeline(filter="all"){
  timeline.innerHTML="";
  points.forEach(p=>{
    if(filter!=="all" && p.espace!==filter) return;
    const step=document.createElement("div");
    step.className="step";
    step.dataset.id=p.id;
    step.innerHTML=`
      <strong>${p.time} ‚Äì ${p.name}</strong>
      <div class="photo"><img src="${p.img}" alt="${p.name}"></div>
      <div class="tags">
        <span class="tag">${p.espace}</span>
        <span class="tag intensity">Intensit√© ${"‚ñà".repeat(p.emotion)}${"‚ñë".repeat(5-p.emotion)}</span>
        <span class="tag">üö∂ ${p.rythme}</span>
      </div>
      <div class="meta">üìç ${p.coords[0]}, ${p.coords[1]} ¬∑ üìê ${p.dim}</div>`;
    step.onclick=()=>focusStep(p.id);
    timeline.appendChild(step);
  });
  fadeInSteps();
}

function fadeInSteps(){
  const steps=document.querySelectorAll(".step");
  steps.forEach((el,i)=>setTimeout(()=>el.classList.add("visible"), i*150));
}

function focusStep(id){
  if(currentStep) currentStep.classList.remove("active");
  const step=document.querySelector(`.step[data-id='${id}']`);
  if(step){
    step.classList.add("active");
    step.scrollIntoView({behavior:"smooth",inline:"center"});
    currentStep=step;
  }
}

// ================== L√©gende ==================
document.querySelectorAll(".legend span").forEach(el=>{
  el.onclick=()=>{
    document.querySelectorAll(".legend span").forEach(s=>s.classList.remove("active"));
    el.classList.add("active");
    renderTimeline(el.dataset.filter);
  }
});

// ================== Carte Leaflet ==================
const map = L.map("map").setView([48.914, 2.372], 14);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { maxZoom: 19 }).addTo(map);

const latlngs=[];
points.forEach(p=>{
  latlngs.push(p.coords);
  const popupContent=`
    <div style="display:flex;gap:10px;max-width:250px;font-size:14px;font-family:sans-serif;">
      <img src="${p.img}" alt="${p.name}" style="width:100px;height:70px;object-fit:cover;border-radius:6px;border:1px solid #ddd;">
      <div style="flex:1;">
        <strong>${p.id}. ${p.name}</strong><br/>
        <div style="margin:4px 0;color:#444;font-size:13px;">
          üìç ${p.coords[0].toFixed(4)}, ${p.coords[1].toFixed(4)}<br/>
          üö∂ ${p.rythme} ¬∑ üìê ${p.dim} ¬∑ ‚ù§Ô∏è Intensit√© ${p.emotion}
        </div>
      </div>
    </div>`;
  const marker=L.marker(p.coords).addTo(map).bindPopup(popupContent);
  marker.on('click',()=>focusStep(p.id));
});
const polyline=L.polyline(latlngs,{color:'#2563eb',weight:4,opacity:0.7}).addTo(map);
map.fitBounds(polyline.getBounds());

// ================== Graphiques ==================
new Chart(document.getElementById('altitudeChart'),{
  type:'line',
  data:{labels:points.map(p=>p.name),datasets:[{label:'Altitude',data:points.map(p=>p.alt),borderColor:'#2563eb',backgroundColor:'rgba(37,99,235,0.1)',tension:0.3,fill:true}]},
  options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
});

new Chart(document.getElementById('emotionChart'),{
  type:'line',
  data:{labels:points.map(p=>p.name),datasets:[{label:'√âmotion',data:points.map(p=>p.emotion),borderColor:'#f59e0b',backgroundColor:'rgba(245,158,11,0.1)',tension:0.3,fill:true}]},
  options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{min:0,max:5,stepSize:1}}}
});

new Chart(document.getElementById('dimensionChart'),{
  type:'bar',
  data:{labels:points.map(p=>p.name),datasets:[
    {label:'Largeur (px)',data:points.map(p=>parseInt(p.dim.split('x')[0])),backgroundColor:'#22c55e'},
    {label:'Hauteur (px)',data:points.map(p=>parseInt(p.dim.split('x')[1])),backgroundColor:'#9333ea'}
  ]},
  options:{responsive:true,plugins:{legend:{position:'top'}}}
});

// Initial render
renderTimeline();
</script>
</body>
</html>
